<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>OFFICE FEAST - ‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏î‡∏à‡∏≤‡∏Å‡∏ï‡∏•‡∏≤‡∏î</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800;900&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#FAF7F2;--card:#FFF;--primary:#E8533F;--primary-dark:#C7402F;--accent:#FF8C42;--green:#2ECC71;--green-dark:#27AE60;--text:#2D2A26;--text-light:#8A8580;--text-mid:#5C5955;--border:#EDE8E1;--shadow:0 2px 16px rgba(45,42,38,.06);--radius:20px;--radius-sm:14px}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Sarabun',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
.header{position:sticky;top:0;z-index:100;background:rgba(250,247,242,.85);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);padding:16px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
.logo{font-family:'Prompt',sans-serif;font-weight:900;font-size:22px;letter-spacing:2px;display:flex;align-items:center;gap:8px}
.logo-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--primary),var(--accent));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;color:#fff;box-shadow:0 4px 12px rgba(232,83,63,.3)}
.header-right{display:flex;align-items:center;gap:10px}
.cart-btn,.admin-btn{position:relative;width:48px;height:48px;background:var(--card);border:none;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;box-shadow:var(--shadow);transition:all .2s}
.cart-btn:active,.admin-btn:active{transform:scale(.92)}
.admin-btn{font-size:18px}
.cart-badge{position:absolute;top:-4px;right:-4px;background:var(--primary);color:#fff;font-family:'Prompt',sans-serif;font-weight:700;font-size:11px;width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(232,83,63,.4);transition:all .3s;opacity:0;transform:scale(0)}
.cart-badge.show{opacity:1;transform:scale(1)}
.page{display:none;padding:20px;padding-bottom:100px;animation:fadeIn .35s ease}.page.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes scaleIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.hero-banner{background:linear-gradient(135deg,var(--primary),var(--accent));border-radius:var(--radius);padding:28px 24px;margin-bottom:28px;position:relative;overflow:hidden;box-shadow:0 8px 32px rgba(232,83,63,.25)}
.hero-banner::before{content:'';position:absolute;top:-40%;right:-20%;width:200px;height:200px;background:rgba(255,255,255,.1);border-radius:50%}
.hero-title{font-family:'Prompt',sans-serif;font-weight:800;font-size:26px;color:#fff;margin-bottom:6px;position:relative;z-index:1}
.hero-subtitle{font-size:15px;color:rgba(255,255,255,.85);position:relative;z-index:1}
.hero-emoji{position:absolute;right:20px;top:50%;transform:translateY(-50%);font-size:64px;z-index:1}
.featured-card{background:var(--card);border-radius:var(--radius);margin-bottom:24px;overflow:hidden;box-shadow:var(--shadow);cursor:pointer;transition:all .3s}
.featured-card:active{transform:scale(.98)}
.featured-img{width:100%;height:200px;background:linear-gradient(135deg,#FFE5D9,#FFC3A0);display:flex;align-items:center;justify-content:center;font-size:80px;position:relative;overflow:hidden}
.featured-img img{width:100%;height:100%;object-fit:cover}
.featured-tag{position:absolute;top:14px;left:14px;background:var(--primary);color:#fff;font-family:'Prompt',sans-serif;font-weight:600;font-size:12px;padding:5px 14px;border-radius:20px;z-index:2}
.featured-info{padding:18px 20px}
.featured-name{font-family:'Prompt',sans-serif;font-weight:700;font-size:20px;margin-bottom:4px}
.featured-price{font-family:'Prompt',sans-serif;font-weight:600;font-size:18px;color:var(--primary)}
.section-title{font-family:'Prompt',sans-serif;font-weight:700;font-size:20px;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.category-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:20px}
.category-card{background:var(--card);border-radius:var(--radius-sm);text-align:center;cursor:pointer;box-shadow:var(--shadow);transition:all .25s;border:2px solid transparent;overflow:hidden}
.category-card:active{transform:scale(.95)}
.category-card:hover{border-color:var(--primary)}
.category-img{width:100%;height:100px;overflow:hidden;display:flex;align-items:center;justify-content:center;font-size:48px;background:#f5f0ea}
.category-img img{width:100%;height:100%;object-fit:cover;transition:transform .3s}
.category-card:hover .category-img img{transform:scale(1.08)}
.category-text{padding:14px 12px}
.category-name{font-family:'Prompt',sans-serif;font-weight:600;font-size:17px}
.category-count{font-size:13px;color:var(--text-light);margin-top:2px}
.back-btn{display:inline-flex;align-items:center;gap:6px;font-family:'Prompt',sans-serif;font-weight:600;font-size:15px;color:var(--text-mid);background:none;border:none;cursor:pointer;margin-bottom:16px;padding:8px 0}
.cat-header{font-family:'Prompt',sans-serif;font-weight:800;font-size:26px;margin-bottom:20px;display:flex;align-items:center;gap:10px}
.product-card{background:var(--card);border-radius:var(--radius-sm);padding:12px;margin-bottom:12px;display:flex;align-items:center;gap:14px;box-shadow:var(--shadow);animation:slideUp .4s ease both}
.product-img{width:72px;height:72px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:36px;flex-shrink:0;overflow:hidden;background:#f5f0ea}
.product-img img{width:100%;height:100%;object-fit:cover}
.product-info{flex:1;min-width:0}
.product-name{font-family:'Prompt',sans-serif;font-weight:600;font-size:16px;margin-bottom:2px}
.product-price{font-family:'Prompt',sans-serif;font-weight:700;font-size:16px;color:var(--primary)}
.product-unit{font-size:13px;color:var(--text-light)}
.qty-control{display:flex;align-items:center;background:var(--bg);border-radius:12px;overflow:hidden;flex-shrink:0}
.qty-btn{width:38px;height:38px;border:none;background:transparent;font-family:'Prompt',sans-serif;font-weight:700;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center}
.qty-btn:active{background:var(--border)}
.qty-btn.minus{color:var(--primary)}.qty-btn.plus{color:var(--green)}
.qty-value{width:32px;text-align:center;font-family:'Prompt',sans-serif;font-weight:700;font-size:16px}
.cart-empty{text-align:center;padding:60px 20px}
.cart-empty-icon{font-size:72px;margin-bottom:16px}
.cart-empty-text{font-family:'Prompt',sans-serif;font-weight:600;font-size:18px;color:var(--text-light)}
.cart-item{background:var(--card);border-radius:var(--radius-sm);padding:12px;margin-bottom:10px;display:flex;align-items:center;gap:12px;box-shadow:var(--shadow)}
.cart-item-img{width:54px;height:54px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;flex-shrink:0;overflow:hidden;background:#f5f0ea}
.cart-item-img img{width:100%;height:100%;object-fit:cover}
.cart-item-info{flex:1;min-width:0}
.cart-item-name{font-family:'Prompt',sans-serif;font-weight:600;font-size:15px}
.cart-item-price{font-family:'Prompt',sans-serif;font-weight:700;font-size:15px;color:var(--primary)}
.remove-btn{width:36px;height:36px;border-radius:10px;border:none;background:#FFF0EE;color:var(--primary);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.summary-card{background:var(--card);border-radius:var(--radius);padding:20px;margin-top:20px;box-shadow:var(--shadow)}
.summary-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;font-size:15px}
.summary-row.total{border-top:2px dashed var(--border);margin-top:8px;padding-top:14px;font-family:'Prompt',sans-serif;font-weight:700;font-size:20px}
.total-amount{color:var(--primary)}
.summary-label{color:var(--text-mid)}
.payment-section{margin-top:24px}
.payment-title{font-family:'Prompt',sans-serif;font-weight:700;font-size:18px;margin-bottom:14px}
.payment-options{display:flex;flex-direction:column;gap:12px}
.payment-option{background:var(--card);border:2px solid var(--border);border-radius:var(--radius-sm);padding:18px;cursor:pointer;transition:all .25s;display:flex;align-items:center;gap:14px}
.payment-option.selected{border-color:var(--primary);background:#FFF8F6;box-shadow:0 0 0 3px rgba(232,83,63,.1)}
.payment-radio{width:24px;height:24px;border-radius:50%;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.payment-option.selected .payment-radio{border-color:var(--primary);background:var(--primary)}
.payment-option.selected .payment-radio::after{content:'\2713';color:#fff;font-size:14px;font-weight:700}
.payment-option-info{flex:1}
.payment-option-title{font-family:'Prompt',sans-serif;font-weight:600;font-size:16px}
.payment-option-desc{font-size:13px;color:var(--text-light);margin-top:2px}
.payment-option-badge{background:var(--accent);color:#fff;font-family:'Prompt',sans-serif;font-weight:600;font-size:11px;padding:3px 10px;border-radius:20px;flex-shrink:0}
.payment-option-badge.free{background:var(--green)}
.input-group{margin-bottom:14px}
.input-label{font-family:'Prompt',sans-serif;font-weight:600;font-size:14px;color:var(--text-mid);margin-bottom:6px;display:block}
.input-field{width:100%;padding:14px 16px;border:2px solid var(--border);border-radius:12px;font-family:'Sarabun',sans-serif;font-size:16px;color:var(--text);background:var(--card);outline:none;transition:border-color .2s}
.input-field:focus{border-color:var(--primary)}
.input-field::placeholder{color:#C5C0BA}
.qr-section{text-align:center;padding:24px;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);margin-top:20px}
.qr-box{width:220px;height:220px;margin:16px auto;background:#fff;border-radius:16px;border:3px solid var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;overflow:hidden}
.qr-box img{width:100%;height:100%;object-fit:contain}
.qr-amount{font-family:'Prompt',sans-serif;font-weight:800;font-size:28px;color:var(--primary);margin-top:12px}
.qr-note{font-size:14px;color:var(--text-light);margin-top:8px}
.btn-primary{width:100%;padding:16px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;border:none;border-radius:14px;font-family:'Prompt',sans-serif;font-weight:700;font-size:17px;cursor:pointer;box-shadow:0 6px 20px rgba(232,83,63,.35);transition:all .25s;margin-top:20px;display:flex;align-items:center;justify-content:center;gap:8px}
.btn-primary:active{transform:scale(.97)}
.btn-success{background:linear-gradient(135deg,var(--green),var(--green-dark));box-shadow:0 6px 20px rgba(46,204,113,.35)}
.btn-outline{width:100%;padding:14px;background:transparent;color:var(--text);border:2px solid var(--border);border-radius:14px;font-family:'Prompt',sans-serif;font-weight:600;font-size:15px;cursor:pointer;margin-top:10px}
.btn-sm{padding:10px 18px;font-size:14px;margin-top:0;width:auto;border-radius:10px}
.bottom-bar{position:fixed;bottom:0;left:0;right:0;background:rgba(250,247,242,.92);backdrop-filter:blur(20px);border-top:1px solid var(--border);padding:12px 20px;padding-bottom:max(12px,env(safe-area-inset-bottom));z-index:100;display:none;animation:slideUp .3s ease}
.bottom-bar.show{display:block}
.bottom-bar-content{display:flex;align-items:center;gap:14px}
.bottom-bar-info{flex:1}
.bottom-bar-items{font-size:13px;color:var(--text-light)}
.bottom-bar-total{font-family:'Prompt',sans-serif;font-weight:700;font-size:20px;color:var(--primary)}
.bottom-bar-btn{padding:14px 28px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;border:none;border-radius:14px;font-family:'Prompt',sans-serif;font-weight:700;font-size:16px;cursor:pointer;box-shadow:0 4px 16px rgba(232,83,63,.35);display:flex;align-items:center;gap:6px}
.success-page{text-align:center;padding:60px 20px}
.success-icon{width:100px;height:100px;border-radius:50%;background:linear-gradient(135deg,var(--green),var(--green-dark));display:flex;align-items:center;justify-content:center;font-size:48px;margin:0 auto 20px;box-shadow:0 8px 32px rgba(46,204,113,.3);animation:scaleIn .5s ease}
.success-title{font-family:'Prompt',sans-serif;font-weight:800;font-size:26px;margin-bottom:8px}
.success-subtitle{font-size:15px;color:var(--text-light);margin-bottom:30px;line-height:1.6}
.order-id{font-family:'Prompt',sans-serif;font-weight:700;font-size:14px;color:var(--accent);background:#FFF3EB;padding:8px 18px;border-radius:20px;display:inline-block;margin-bottom:24px}
.toast{position:fixed;bottom:90px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--text);color:#fff;padding:12px 24px;border-radius:12px;font-family:'Prompt',sans-serif;font-weight:500;font-size:14px;z-index:200;opacity:0;transition:all .35s cubic-bezier(.175,.885,.32,1.275);box-shadow:0 8px 24px rgba(0,0,0,.2);white-space:nowrap}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* === ADMIN === */
.admin-header{background:linear-gradient(135deg,#2D2A26,#4A4540);border-radius:var(--radius);padding:24px;margin-bottom:24px;color:#fff;position:relative;overflow:hidden}
.admin-header::before{content:'';position:absolute;top:-30%;right:-10%;width:180px;height:180px;background:rgba(255,255,255,.05);border-radius:50%}
.admin-header h2{font-family:'Prompt',sans-serif;font-weight:800;font-size:22px;margin-bottom:4px;position:relative;z-index:1}
.admin-header p{font-size:14px;opacity:.7;position:relative;z-index:1}
.admin-stat-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:24px}
.admin-stat{background:var(--card);border-radius:var(--radius-sm);padding:18px;box-shadow:var(--shadow);text-align:center}
.admin-stat-num{font-family:'Prompt',sans-serif;font-weight:800;font-size:28px;color:var(--primary)}
.admin-stat-label{font-size:13px;color:var(--text-light);margin-top:2px}
.admin-section{margin-bottom:24px}
.admin-section-title{font-family:'Prompt',sans-serif;font-weight:700;font-size:18px;margin-bottom:14px;display:flex;align-items:center;justify-content:space-between}
.admin-cat-header{background:var(--card);border-radius:var(--radius-sm);padding:14px 16px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--shadow);border-left:4px solid var(--primary)}
.admin-cat-name{font-family:'Prompt',sans-serif;font-weight:700;font-size:16px;display:flex;align-items:center;gap:8px}
.admin-cat-actions{display:flex;gap:6px}
.admin-item{background:var(--card);border-radius:var(--radius-sm);padding:14px;margin-bottom:10px;display:flex;align-items:center;gap:12px;box-shadow:var(--shadow)}
.admin-item-img{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;flex-shrink:0;overflow:hidden;background:#f5f0ea}
.admin-item-img img{width:100%;height:100%;object-fit:cover}
.admin-item-info{flex:1;min-width:0}
.admin-item-name{font-family:'Prompt',sans-serif;font-weight:600;font-size:15px}
.admin-item-detail{font-size:13px;color:var(--text-light)}
.admin-item-actions{display:flex;gap:6px;flex-shrink:0}
.admin-item-actions button{width:36px;height:36px;border-radius:10px;border:none;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center}
.btn-edit{background:#EBF5FF;color:#3498db}
.btn-del{background:#FFF0EE;color:var(--primary)}
.order-card{background:var(--card);border-radius:var(--radius-sm);padding:16px;margin-bottom:12px;box-shadow:var(--shadow)}
.order-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.order-card-id{font-family:'Prompt',sans-serif;font-weight:700;font-size:14px;color:var(--accent)}
.order-card-date{font-size:12px;color:var(--text-light)}
.order-card-customer{font-family:'Prompt',sans-serif;font-weight:600;font-size:15px}
.order-card-items{font-size:13px;color:var(--text-light);margin:4px 0}
.order-card-total{font-family:'Prompt',sans-serif;font-weight:700;font-size:16px;color:var(--primary)}
.order-status{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-family:'Prompt',sans-serif;font-weight:600}
.status-paid{background:#E8F8F0;color:var(--green-dark)}
.status-pending{background:#FFF3E0;color:#E67E22}
.empty-state{text-align:center;padding:40px 20px;color:var(--text-light)}
.empty-state-icon{font-size:48px;margin-bottom:12px}
.dots-pattern{position:fixed;top:0;left:0;right:0;bottom:0;background-image:radial-gradient(circle,#E0DBD4 1px,transparent 1px);background-size:24px 24px;opacity:.3;pointer-events:none;z-index:-1}

/* === UPLOAD === */
.upload-area{width:100%;aspect-ratio:1;max-width:220px;margin:0 auto 16px;border:3px dashed var(--border);border-radius:var(--radius);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .25s;overflow:hidden;position:relative;background:var(--card)}
.upload-area:active{transform:scale(.97)}
.upload-area.has-img{border-style:solid;border-color:var(--green)}
.upload-area img{width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0}
.upload-area .upload-icon{font-size:48px;margin-bottom:8px;transition:all .2s}
.upload-area .upload-text{font-family:'Prompt',sans-serif;font-weight:600;font-size:14px;color:var(--text-light);text-align:center}
.upload-area .upload-hint{font-size:12px;color:var(--text-light);margin-top:4px}
.upload-area .remove-img{position:absolute;top:8px;right:8px;width:32px;height:32px;border-radius:50%;background:rgba(0,0,0,.6);color:#fff;border:none;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:3}
.upload-btns{display:flex;gap:10px;justify-content:center;margin-bottom:16px}
.upload-btns button{padding:10px 20px;border:2px solid var(--border);border-radius:12px;background:var(--card);font-family:'Prompt',sans-serif;font-weight:600;font-size:14px;cursor:pointer;display:flex;align-items:center;gap:6px;transition:all .2s}
.upload-btns button:active{transform:scale(.95);background:var(--bg)}

/* === MODAL === */
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:300;display:none;align-items:flex-end;justify-content:center;animation:fadeIn .2s ease}
.modal-overlay.show{display:flex}
.modal{background:var(--bg);border-radius:24px 24px 0 0;padding:24px;width:100%;max-width:500px;max-height:85vh;overflow-y:auto;animation:slideUp .3s ease}
.modal h3{font-family:'Prompt',sans-serif;font-weight:700;font-size:20px;margin-bottom:20px;display:flex;align-items:center;gap:8px}
</style>
</head>
<body>
<div class="dots-pattern"></div>
<div class="header">
  <div class="logo"><div class="logo-icon">üç±</div>OFFICE FEAST</div>
  <div class="header-right">
    <button class="admin-btn" onclick="openAdminLogin()" title="Admin">‚öôÔ∏è</button>
    <button class="cart-btn" onclick="showCart()">üõí<div class="cart-badge" id="cartBadge">0</div></button>
  </div>
</div>

<div class="page active" id="homePage">
  <div class="hero-banner"><div class="hero-title">‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏î‡∏à‡∏≤‡∏Å‡∏ï‡∏•‡∏≤‡∏î</div><div class="hero-subtitle">‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô üöõ</div><div class="hero-emoji">ü¶ê</div></div>
  <div id="featuredArea"></div>
  <div class="section-title">üì¶ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
  <div class="category-grid" id="categoryGrid"></div>
</div>

<div class="page" id="categoryPage">
  <button class="back-btn" onclick="goHome()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  <div class="cat-header" id="catHeader"></div>
  <div id="productList"></div>
</div>

<div class="page" id="cartPage">
  <button class="back-btn" onclick="goHome()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  <div class="cat-header">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</div>
  <div id="cartList"></div>
  <div id="cartSummary"></div>
</div>

<div class="page" id="checkoutPage">
  <button class="back-btn" onclick="showCart()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
  <div class="cat-header">üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
  <div class="input-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input class="input-field" type="text" id="custName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"></div>
  <div class="input-group"><label class="input-label">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label><input class="input-field" type="text" id="custDept" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ù‡πà‡∏≤‡∏¢‡∏ú‡∏•‡∏¥‡∏ï, QC"></div>
  <div class="input-group"><label class="input-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label><input class="input-field" type="tel" id="custPhone" placeholder="08X-XXX-XXXX"></div>
  <div class="payment-section">
    <div class="payment-title">üí∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
    <div class="payment-options">
      <div class="payment-option selected" onclick="selectPayment('now')"><div class="payment-radio"></div><div class="payment-option-info"><div class="payment-option-title">‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏•‡∏¢‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div><div class="payment-option-desc">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div></div><div class="payment-option-badge free">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°</div></div>
      <div class="payment-option" onclick="selectPayment('later')"><div class="payment-radio"></div><div class="payment-option-info"><div class="payment-option-title">‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25 (‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å)</div><div class="payment-option-desc">‡∏´‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô +20 ‡∏ö‡∏≤‡∏ó</div></div><div class="payment-option-badge">+20 ‡∏ø</div></div>
    </div>
  </div>
  <div id="checkoutSummary"></div>
  <div id="qrSection" style="display:none"><div class="qr-section">
    <div style="font-family:'Prompt';font-weight:700;font-size:16px">‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
    <div class="qr-box" id="qrBox"></div>
    <div class="qr-amount" id="qrAmount">‡∏ø0</div>
    <div class="qr-note">‡∏™‡πÅ‡∏Å‡∏ô‡∏ú‡πà‡∏≤‡∏ô Mobile Banking / PromptPay</div>
  </div></div>
  <button class="btn-primary btn-success" onclick="confirmOrder()">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
</div>

<div class="page" id="successPage">
  <div class="success-page">
    <div class="success-icon">‚úÖ</div>
    <div class="success-title">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ</div>
    <div id="orderIdDisplay" class="order-id"></div>
    <div class="success-subtitle" id="successMsg"></div>
    <button class="btn-primary" onclick="resetAll()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  </div>
</div>

<div class="page" id="adminPage">
  <button class="back-btn" onclick="goHome()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</button>
  <div class="admin-header"><h2>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</h2><p>‡πÄ‡∏û‡∏¥‡πà‡∏° / ‡∏•‡∏ö / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p></div>
  <div class="admin-stat-grid" id="adminStats"></div>
  <div class="admin-section">
    <div class="admin-section-title">üìã ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î <button class="btn-primary btn-sm" onclick="clearOrders()" style="background:#e74c3c;box-shadow:none;font-size:12px;padding:6px 12px">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á</button></div>
    <div id="orderList"></div>
  </div>
  <div class="admin-section">
    <div class="admin-section-title">üì¶ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà & ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <button class="btn-primary btn-sm btn-success" onclick="openAddCatModal()">+ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</button></div>
    <div id="adminProductList"></div>
  </div>
  <div class="admin-section">
    <div class="admin-section-title">üîß ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
    <div class="input-group"><label class="input-label">QR PromptPay</label>
      <div class="upload-area" id="qrUploadArea" onclick="document.getElementById('qrUploadInput').click()" style="max-width:180px;aspect-ratio:1">
        <span class="upload-icon">üì±</span><span class="upload-text">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î QR ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô</span>
      </div>
      <input type="file" id="qrUploadInput" accept="image/*" style="display:none" onchange="handleQrUpload(this)">
    </div>
    <div class="input-group"><label class="input-label">‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25 (‡∏ö‡∏≤‡∏ó)</label><input class="input-field" type="number" id="adminFee" placeholder="20"></div>
    <div class="input-group"><label class="input-label">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin</label><input class="input-field" type="text" id="adminNewPass" placeholder="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà"></div>
    <button class="btn-primary" onclick="saveSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
  </div>
</div>

<div class="bottom-bar" id="bottomBar">
  <div class="bottom-bar-content">
    <div class="bottom-bar-info"><div class="bottom-bar-items" id="bottomItems">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div><div class="bottom-bar-total" id="bottomTotal">‡∏ø0</div></div>
    <button class="bottom-bar-btn" onclick="showCart()">üõí ‡∏î‡∏π‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
  </div>
</div>
<div class="modal-overlay" id="modalOverlay" onclick="if(event.target===this)closeModal()"><div class="modal" id="modalContent"></div></div>
<div class="toast" id="toast"></div>

<script>
// === DEFAULT DATA ===
const DEFAULT_CATS={
  shrimp:{name:'‡∏Å‡∏∏‡πâ‡∏á 13 ‡∏ï‡∏±‡∏ß/‡πÇ‡∏•',emoji:'ü¶ê',img:'',featured:true,featuredPrice:'350 ‚Äì 380 ‡∏ö‡∏≤‡∏ó',items:[
    {id:'s1',name:'‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î',price:350,emoji:'ü¶ê',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF0EB'},
    {id:'s2',name:'‡∏Å‡∏∏‡πâ‡∏á‡πÄ‡∏ú‡∏≤',price:350,emoji:'üî•',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF3E0'}]},
  fruit:{name:'‡∏ú‡∏•‡πÑ‡∏°‡πâ',emoji:'üçé',img:'',items:[
    {id:'f1',name:'‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',price:450,emoji:'üçà',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF9E6'},
    {id:'f2',name:'‡∏™‡πâ‡∏°',price:30,emoji:'üçä',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF3E0'},
    {id:'f3',name:'‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà',price:10,emoji:'üçì',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFEBEE'}]},
  meat:{name:'‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå',emoji:'ü•©',img:'',items:[
    {id:'m1',name:'‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô',price:100,emoji:'ü•ì',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFEBEE'},
    {id:'m2',name:'‡∏™‡∏±‡∏ô‡∏Ñ‡∏≠',price:100,emoji:'ü•©',img:'',unit:'‡∏Å‡∏Å.',bg:'#FCE4EC'},
    {id:'m3',name:'‡∏ã‡∏µ‡πà‡πÇ‡∏Ñ‡∏£‡∏á',price:100,emoji:'üçñ',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF3E0'},
    {id:'m4',name:'‡∏≠‡∏Å',price:50,emoji:'üçó',img:'',unit:'‡∏Å‡∏Å.',bg:'#E8F5E9'},
    {id:'m5',name:'‡∏™‡∏∞‡πÇ‡∏û‡∏Å',price:50,emoji:'üçó',img:'',unit:'‡∏Å‡∏Å.',bg:'#E0F2F1'},
    {id:'m6',name:'‡∏õ‡∏≠‡∏á‡∏ã‡∏≤',price:450,emoji:'üçó',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF8E1'},
    {id:'m7',name:'‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°',price:50,emoji:'üêü',img:'',unit:'‡∏Å‡∏Å.',bg:'#E3F2FD'},
    {id:'m8',name:'‡∏õ‡∏•‡∏≤‡∏ô‡∏¥‡∏•',price:50,emoji:'üêü',img:'',unit:'‡∏Å‡∏Å.',bg:'#E8EAF6'},
    {id:'m9',name:'‡∏™‡∏∞‡∏≠‡∏µ‡πä‡∏î',price:50,emoji:'üêü',img:'',unit:'‡∏Å‡∏Å.',bg:'#F3E5F5'}]},
  seafood:{name:'‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∞‡πÄ‡∏•',emoji:'ü¶ê',img:'',items:[
    {id:'sf1',name:'‡∏´‡∏≠‡∏¢‡πÅ‡∏Ñ‡∏£‡∏á',price:10,emoji:'ü¶™',img:'',unit:'‡∏Å‡∏Å.',bg:'#ECEFF1'},
    {id:'sf2',name:'‡∏õ‡∏π‡∏°‡πâ‡∏≤',price:20,emoji:'ü¶Ä',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFF3E0'},
    {id:'sf3',name:'‡πÅ‡∏°‡∏á‡∏Å‡∏∏‡πâ‡∏á',price:50,emoji:'ü¶û',img:'',unit:'‡∏Å‡∏Å.',bg:'#FFEBEE'}]},
  readymade:{name:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ',emoji:'üç±',img:'',items:[
    {id:'r1',name:'‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏°',price:450,emoji:'ü•ö',img:'',unit:'‡∏ñ‡∏≤‡∏î',bg:'#FFF9C4'},
    {id:'r2',name:'‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å',price:450,emoji:'üå∂Ô∏è',img:'',unit:'‡∏ñ‡∏∏‡∏á',bg:'#FFCCBC'},
    {id:'r3',name:'‡∏ä‡∏µ‡∏™‡πÄ‡∏Ñ‡πâ‡∏Å',price:450,emoji:'üç∞',img:'',unit:'‡∏ä‡∏¥‡πâ‡∏ô',bg:'#FFF3E0'}]}
};
const DEFAULT_SET={qrImg:'',laterFee:20,adminPass:'1234'};

// === DB ===
function ld(k,d){try{const v=JSON.parse(localStorage.getItem(k));return v||d}catch(e){return d}}
function sv(k,v){try{localStorage.setItem(k,JSON.stringify(v))}catch(e){
  if(e.name==='QuotaExceededError'){showToast('‚ö†Ô∏è ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏°! ‡∏•‡∏≠‡∏á‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ');return false}
}return true}

let cats=ld('of_cats',null)||JSON.parse(JSON.stringify(DEFAULT_CATS));
let settings=Object.assign({},DEFAULT_SET,ld('of_set',{}));
let orders=ld('of_orders',[]);
let cart={},payMethod='now';
// temp upload holder for modals
let tempUploadImg='';

function persist(){sv('of_cats',cats)}

// === IMAGE COMPRESS & UPLOAD ===
function compressImage(file,maxW,quality){
  return new Promise((resolve)=>{
    const reader=new FileReader();
    reader.onload=function(e){
      const img=new Image();
      img.onload=function(){
        const canvas=document.createElement('canvas');
        let w=img.width,h=img.height;
        if(w>maxW){h=Math.round(h*(maxW/w));w=maxW}
        if(h>maxW){w=Math.round(w*(maxW/h));h=maxW}
        canvas.width=w;canvas.height=h;
        const ctx=canvas.getContext('2d');
        ctx.drawImage(img,0,0,w,h);
        resolve(canvas.toDataURL('image/jpeg',quality));
      };
      img.src=e.target.result;
    };
    reader.readAsDataURL(file);
  });
}

function triggerUpload(inputId,mode){
  const inp=document.getElementById(inputId);
  if(mode==='camera') inp.setAttribute('capture','environment');
  else inp.removeAttribute('capture');
  inp.click();
}

async function handleModalUpload(input){
  if(!input.files||!input.files[0])return;
  showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏µ‡∏ö‡∏£‡∏π‡∏õ...');
  const compressed=await compressImage(input.files[0],400,0.7);
  tempUploadImg=compressed;
  const area=document.getElementById('modalUploadArea');
  area.innerHTML='<img src="'+compressed+'" alt="preview"><button class="remove-img" onclick="event.stopPropagation();clearModalUpload()">‚úï</button>';
  area.classList.add('has-img');
  showToast('‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
  input.value='';
}

function clearModalUpload(){
  tempUploadImg='';
  const area=document.getElementById('modalUploadArea');
  area.innerHTML='<span class="upload-icon">üì∑</span><span class="upload-text">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span class="upload-hint">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà</span>';
  area.classList.remove('has-img');
}

async function handleQrUpload(input){
  if(!input.files||!input.files[0])return;
  showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏µ‡∏ö‡∏£‡∏π‡∏õ...');
  const compressed=await compressImage(input.files[0],300,0.8);
  settings.qrImg=compressed;
  sv('of_set',settings);
  renderQrUploadArea();
  showToast('‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î QR ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
  input.value='';
}

function renderQrUploadArea(){
  const area=document.getElementById('qrUploadArea');
  if(settings.qrImg){
    area.innerHTML='<img src="'+settings.qrImg+'" alt="QR"><button class="remove-img" onclick="event.stopPropagation();settings.qrImg=\'\';sv(\'of_set\',settings);renderQrUploadArea()">‚úï</button>';
    area.classList.add('has-img');
  }else{
    area.innerHTML='<span class="upload-icon">üì±</span><span class="upload-text">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î QR ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô</span>';
    area.classList.remove('has-img');
  }
}

// === HELPERS ===
function imgH(src,emoji){
  if(!src)return emoji;
  return '<img src="'+src+'" alt="" onerror="this.outerHTML=\''+emoji+'\'">';
}
function gid(){return 'p'+Date.now().toString(36)+Math.random().toString(36).substr(2,4)}
function showToast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000)}
function showPage(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');window.scrollTo(0,0)}
function goHome(){showPage('homePage');renderHome();updateBB()}
function openModal(h){document.getElementById('modalContent').innerHTML=h;document.getElementById('modalOverlay').classList.add('show')}
function closeModal(){document.getElementById('modalOverlay').classList.remove('show');tempUploadImg=''}

// === CUSTOMER PAGES ===
function renderHome(){
  let fh='';const fc=Object.entries(cats).find(([k,c])=>c.featured);
  if(fc){const[fid,c]=fc;fh='<div class="featured-card" onclick="goToCat(\''+fid+'\')"><div class="featured-img">'+imgH(c.featuredImg||c.img,c.emoji)+'<div class="featured-tag">‚≠ê ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div></div><div class="featured-info"><div class="featured-name">'+c.name+'</div><div class="featured-price">'+(c.featuredPrice||'')+'</div></div></div>'}
  document.getElementById('featuredArea').innerHTML=fh;
  let h='';for(const[id,c] of Object.entries(cats)){if(c.featured)continue;if(!(c.items||[]).length)continue;
    h+='<div class="category-card" onclick="goToCat(\''+id+'\')"><div class="category-img">'+imgH(c.img,c.emoji)+'</div><div class="category-text"><div class="category-name">'+c.name+'</div><div class="category-count">'+c.items.length+' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div></div>'}
  document.getElementById('categoryGrid').innerHTML=h;
}

function goToCat(cid){
  const c=cats[cid];if(!c)return;
  document.getElementById('catHeader').innerHTML=c.emoji+' '+c.name;
  let h='';(c.items||[]).forEach(it=>{const q=cart[it.id]||0;
    h+='<div class="product-card"><div class="product-img" style="background:'+(it.bg||'#f5f0ea')+'">'+imgH(it.img,it.emoji)+'</div><div class="product-info"><div class="product-name">'+it.name+'</div><div class="product-price">‡∏ø'+it.price+' <span class="product-unit">/ '+(it.unit||'‡∏ä‡∏¥‡πâ‡∏ô')+'</span></div></div><div class="qty-control"><button class="qty-btn minus" onclick="chgQty(\''+it.id+'\',-1)">‚àí</button><div class="qty-value" id="qty-'+it.id+'">'+q+'</div><button class="qty-btn plus" onclick="chgQty(\''+it.id+'\',1)">+</button></div></div>'});
  if(!h)h='<div class="empty-state"><div class="empty-state-icon">üì≠</div>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>';
  document.getElementById('productList').innerHTML=h;showPage('categoryPage');updateBB();
}

function chgQty(id,d){if(!cart[id])cart[id]=0;cart[id]=Math.max(0,cart[id]+d);if(!cart[id])delete cart[id];
  const el=document.getElementById('qty-'+id);if(el){el.textContent=cart[id]||0;el.style.transform='scale(1.3)';setTimeout(()=>el.style.transform='scale(1)',150)}
  updateBadge();updateBB();if(d>0)showToast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‚úì')}
function findP(id){for(const c of Object.values(cats)){const f=(c.items||[]).find(p=>p.id===id);if(f)return f}return null}
function gTotal(){let t=0;for(const[id,q]of Object.entries(cart)){const p=findP(id);if(p)t+=p.price*q}return t}
function gCount(){return Object.values(cart).reduce((a,b)=>a+b,0)}
function updateBadge(){const c=gCount(),b=document.getElementById('cartBadge');b.textContent=c;b.classList.toggle('show',c>0)}
function updateBB(){const c=gCount(),t=gTotal(),bar=document.getElementById('bottomBar');
  const hide=['cartPage','checkoutPage','successPage','adminPage'].some(id=>document.getElementById(id).classList.contains('active'));
  if(c>0&&!hide){bar.classList.add('show');document.getElementById('bottomItems').textContent=c+' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';document.getElementById('bottomTotal').textContent='‡∏ø'+t.toLocaleString()}else bar.classList.remove('show')}

function showCart(){
  const items=Object.entries(cart),L=document.getElementById('cartList'),S=document.getElementById('cartSummary');
  if(!items.length){L.innerHTML='<div class="cart-empty"><div class="cart-empty-icon">üõí</div><div class="cart-empty-text">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</div><div style="font-size:14px;color:var(--text-light)">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div><button class="btn-outline" onclick="goHome()" style="margin-top:20px">üè† ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button></div>';S.innerHTML=''}
  else{let h='',total=0;items.forEach(([id,qty])=>{const p=findP(id);if(!p)return;const sub=p.price*qty;total+=sub;
    h+='<div class="cart-item"><div class="cart-item-img" style="background:'+(p.bg||'#f5f0ea')+'">'+imgH(p.img,p.emoji)+'</div><div class="cart-item-info"><div class="cart-item-name">'+p.name+'</div><div class="cart-item-price">‡∏ø'+p.price+' √ó '+qty+' = ‡∏ø'+sub.toLocaleString()+'</div></div><div class="qty-control"><button class="qty-btn minus" onclick="chgC(\''+id+'\',-1)">‚àí</button><div class="qty-value">'+qty+'</div><button class="qty-btn plus" onclick="chgC(\''+id+'\',1)">+</button></div><button class="remove-btn" onclick="rmCart(\''+id+'\')">‚úï</button></div>'});
    L.innerHTML=h;S.innerHTML='<div class="summary-card"><div class="summary-row"><span class="summary-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span>'+gCount()+' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span></div><div class="summary-row"><span class="summary-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span><span>‡∏ø'+total.toLocaleString()+'</span></div><div class="summary-row total"><span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span><span class="total-amount">‡∏ø'+total.toLocaleString()+'</span></div></div><button class="btn-primary" onclick="goCheckout()">üí≥ ‡πÑ‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button><button class="btn-outline" onclick="goHome()">‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°</button>'}
  showPage('cartPage');updateBB()}
function chgC(id,d){if(!cart[id])cart[id]=0;cart[id]=Math.max(0,cart[id]+d);if(!cart[id])delete cart[id];updateBadge();showCart()}
function rmCart(id){delete cart[id];updateBadge();showCart();showToast('‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß')}

function goCheckout(){payMethod='now';updCS();updPay();showPage('checkoutPage');updateBB()}
function selectPayment(m){payMethod=m;updPay();updCS()}
function updPay(){document.querySelectorAll('.payment-option').forEach((el,i)=>el.classList.toggle('selected',(i===0&&payMethod==='now')||(i===1&&payMethod==='later')));
  const qs=document.getElementById('qrSection');if(payMethod==='now'){qs.style.display='block';
    const qb=document.getElementById('qrBox');
    if(settings.qrImg)qb.innerHTML='<img src="'+settings.qrImg+'" alt="QR">';else qb.innerHTML='<div style="font-size:50px">üì±</div><div style="font-size:12px;color:var(--text-light);text-align:center;padding:0 12px">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î QR ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin</div>';
    document.getElementById('qrAmount').textContent='‡∏ø'+gTotal().toLocaleString()}else qs.style.display='none'}
function updCS(){const t=gTotal(),fee=payMethod==='later'?settings.laterFee:0,f=t+fee;
  document.getElementById('checkoutSummary').innerHTML='<div class="summary-card"><div class="summary-row"><span class="summary-label">‡∏¢‡∏≠‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span>‡∏ø'+t.toLocaleString()+'</span></div>'+(fee?'<div class="summary-row"><span class="summary-label">‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25</span><span style="color:var(--accent)">+‡∏ø'+fee+'</span></div>':'')+'<div class="summary-row total"><span>‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞</span><span class="total-amount">‡∏ø'+f.toLocaleString()+'</span></div></div>'}

function confirmOrder(){
  const name=document.getElementById('custName').value.trim();if(!name){showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠');document.getElementById('custName').focus();return}
  const dept=document.getElementById('custDept').value.trim(),phone=document.getElementById('custPhone').value.trim();
  const fee=payMethod==='later'?settings.laterFee:0,total=gTotal()+fee;
  const oid='OF-'+Date.now().toString(36).toUpperCase();
  const oi=[];for(const[id,qty]of Object.entries(cart)){const p=findP(id);if(p)oi.push({name:p.name,price:p.price,qty,emoji:p.emoji})}
  orders.unshift({id:oid,date:new Date().toLocaleString('th-TH'),name,dept,phone,items:oi,total,payment:payMethod==='now'?'‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß':'‡∏£‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25',status:payMethod==='now'?'paid':'pending'});
  if(orders.length>100)orders=orders.slice(0,100);sv('of_orders',orders);
  document.getElementById('orderIdDisplay').textContent='‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå: '+oid;
  let msg='‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á '+name;if(dept)msg+=' ('+dept+')';msg+='<br>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° ‡∏ø'+total.toLocaleString();
  msg+=payMethod==='later'?'<br>üí∏ ‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25':'<br>‚úÖ ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß';msg+='<br><br>‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞ üöõ';
  document.getElementById('successMsg').innerHTML=msg;

  // ‚òÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏õ Google Sheets + ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô LINE ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‚òÖ
  try{fetch('https://script.google.com/macros/s/AKfycbyY-4xcFk1tyNEZNtuCzsUSS0DxkjAwliup8uFjbcEVshXEKc5un2vIxKvn05iuvuwHjQ/exec',{
    method:'POST',mode:'no-cors',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      date:new Date().toLocaleString('th-TH'),
      orderId:oid,name:name,dept:dept,
      items:oi.map(function(i){return i.emoji+i.name+'x'+i.qty}).join(', '),
      total:total,
      payment:payMethod==='now'?'‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß':'‡∏£‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25'
    })
  })}catch(e){}

  showPage('successPage');updateBB()}
function resetAll(){cart={};payMethod='now';['custName','custDept','custPhone'].forEach(id=>document.getElementById(id).value='');updateBadge();goHome()}

// === ADMIN ===
function openAdminLogin(){
  openModal('<h3>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</h3><div class="input-group"><label class="input-label">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label><input class="input-field" type="password" id="adminPassInput" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" onkeydown="if(event.key===\'Enter\')doLogin()"></div><button class="btn-primary" onclick="doLogin()">üîì ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button><div style="text-align:center;margin-top:12px;font-size:13px;color:var(--text-light)">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: 1234</div>');
  setTimeout(()=>{const el=document.getElementById('adminPassInput');if(el)el.focus()},300)}
function doLogin(){const p=document.getElementById('adminPassInput').value;if(p===settings.adminPass){closeModal();openAdmin()}else showToast('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚ùå')}

function openAdmin(){showPage('adminPage');updateBB();renderAdminStats();renderAdminOrders();renderAdminProducts();
  renderQrUploadArea();document.getElementById('adminFee').value=settings.laterFee||20;document.getElementById('adminNewPass').value=''}

function renderAdminStats(){let tp=0,tc=Object.keys(cats).length;for(const c of Object.values(cats))tp+=(c.items||[]).length;
  document.getElementById('adminStats').innerHTML='<div class="admin-stat"><div class="admin-stat-num">'+tc+'</div><div class="admin-stat-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</div></div><div class="admin-stat"><div class="admin-stat-num">'+tp+'</div><div class="admin-stat-label">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div></div><div class="admin-stat"><div class="admin-stat-num">'+orders.length+'</div><div class="admin-stat-label">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div></div><div class="admin-stat"><div class="admin-stat-num">‡∏ø'+(orders.reduce((a,o)=>a+o.total,0)).toLocaleString()+'</div><div class="admin-stat-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div></div>'}

function renderAdminOrders(){const el=document.getElementById('orderList');if(!orders.length){el.innerHTML='<div class="empty-state"><div class="empty-state-icon">üìã</div>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>';return}
  let h='';orders.slice(0,20).forEach(o=>{const is=o.items.map(i=>i.emoji+i.name+'√ó'+i.qty).join(', ');
    h+='<div class="order-card"><div class="order-card-header"><span class="order-card-id">'+o.id+'</span><span class="order-card-date">'+o.date+'</span></div><div class="order-card-customer">'+o.name+(o.dept?' ('+o.dept+')':'')+'</div><div class="order-card-items">'+is+'</div><div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px"><span class="order-card-total">‡∏ø'+o.total.toLocaleString()+'</span><span class="order-status '+(o.status==='paid'?'status-paid':'status-pending')+'">'+o.payment+'</span></div></div>'});
  el.innerHTML=h}
function clearOrders(){if(confirm('‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')){orders=[];sv('of_orders',orders);renderAdminStats();renderAdminOrders();showToast('‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß')}}

function renderAdminProducts(){
  let h='';for(const[cid,c]of Object.entries(cats)){
    h+='<div class="admin-cat-header"><div class="admin-cat-name">'+c.emoji+' '+c.name+' <span style="font-weight:400;font-size:13px;color:var(--text-light)">'+(c.items||[]).length+'</span></div><div class="admin-cat-actions"><button class="btn-primary btn-sm btn-success" onclick="openAddItemModal(\''+cid+'\')" style="font-size:12px;padding:6px 12px">+ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button><button class="btn-edit" style="width:32px;height:32px;border-radius:8px;border:none;cursor:pointer" onclick="openEditCatModal(\''+cid+'\')">‚úèÔ∏è</button><button class="btn-del" style="width:32px;height:32px;border-radius:8px;border:none;cursor:pointer" onclick="delCat(\''+cid+'\')">üóëÔ∏è</button></div></div>';
    (c.items||[]).forEach(it=>{
      const hasImg=it.img?'üì∑':'';
      h+='<div class="admin-item"><div class="admin-item-img" style="background:'+(it.bg||'#f5f0ea')+'">'+imgH(it.img,it.emoji)+'</div><div class="admin-item-info"><div class="admin-item-name">'+it.name+'</div><div class="admin-item-detail">‡∏ø'+it.price+' / '+(it.unit||'‡∏ä‡∏¥‡πâ‡∏ô')+' '+hasImg+'</div></div><div class="admin-item-actions"><button class="btn-edit" onclick="openEditItemModal(\''+cid+'\',\''+it.id+'\')">‚úèÔ∏è</button><button class="btn-del" onclick="delItem(\''+cid+'\',\''+it.id+'\')">üóëÔ∏è</button></div></div>'})}
  document.getElementById('adminProductList').innerHTML=h}

function uploadModalHTML(existingImg){
  const hasImg=existingImg?true:false;
  return '<div class="input-group"><label class="input-label">üì∑ ‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>'+
    '<div class="upload-area '+(hasImg?'has-img':'')+'" id="modalUploadArea" onclick="document.getElementById(\'modalFileInput\').click()">'+
    (hasImg?'<img src="'+existingImg+'" alt=""><button class="remove-img" onclick="event.stopPropagation();clearModalUpload()">‚úï</button>':
    '<span class="upload-icon">üì∑</span><span class="upload-text">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span class="upload-hint">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà</span>')+
    '</div>'+
    '<div class="upload-btns">'+
    '<button type="button" onclick="triggerUpload(\'modalFileInput\',\'camera\')">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</button>'+
    '<button type="button" onclick="triggerUpload(\'modalFileInput\',\'gallery\')">üñºÔ∏è ‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà</button>'+
    '</div>'+
    '<input type="file" id="modalFileInput" accept="image/*" style="display:none" onchange="handleModalUpload(this)">'+
    '</div>';
}

// === ADD CAT ===
function openAddCatModal(){tempUploadImg='';
  openModal('<h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà</h3>'+
    '<div class="input-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label><input class="input-field" id="m_cn" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°"></div>'+
    '<div class="input-group"><label class="input-label">Emoji</label><input class="input-field" id="m_ce" placeholder="ü•§" maxlength="4"></div>'+
    uploadModalHTML('')+
    '<button class="btn-primary btn-success" onclick="doAddCat()">‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</button>')}
function doAddCat(){const name=document.getElementById('m_cn').value.trim();if(!name){showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠');return}
  const id='cat_'+Date.now().toString(36);cats[id]={name,emoji:document.getElementById('m_ce').value.trim()||'üì¶',img:tempUploadImg,items:[]};
  persist();closeModal();renderAdminProducts();renderAdminStats();showToast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß ‚úÖ')}

// === EDIT CAT ===
function openEditCatModal(cid){const c=cats[cid];if(!c)return;tempUploadImg=c.img||'';
  openModal('<h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>'+
    '<div class="input-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠</label><input class="input-field" id="m_cn" value="'+c.name+'"></div>'+
    '<div class="input-group"><label class="input-label">Emoji</label><input class="input-field" id="m_ce" value="'+c.emoji+'" maxlength="4"></div>'+
    uploadModalHTML(c.img||'')+
    '<div class="input-group"><label class="input-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</label><input class="input-field" id="m_cfp" value="'+(c.featuredPrice||'')+'"></div>'+
    '<label style="display:flex;align-items:center;gap:8px;margin:12px 0;cursor:pointer"><input type="checkbox" id="m_cf" '+(c.featured?'checked':'')+' style="width:20px;height:20px"> ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>'+
    '<button class="btn-primary" onclick="doEditCat(\''+cid+'\')">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>')}
function doEditCat(cid){const c=cats[cid];c.name=document.getElementById('m_cn').value.trim()||c.name;c.emoji=document.getElementById('m_ce').value.trim()||c.emoji;c.img=tempUploadImg;c.featuredPrice=document.getElementById('m_cfp').value.trim();
  const isFeat=document.getElementById('m_cf').checked;for(const x of Object.values(cats))x.featured=false;if(isFeat)c.featured=true;
  persist();closeModal();renderAdminProducts();showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úÖ')}

function delCat(cid){const c=cats[cid];if(!c)return;if(!confirm('‡∏•‡∏ö "'+c.name+'" ?'))return;delete cats[cid];persist();renderAdminProducts();renderAdminStats();showToast('‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß')}

// === ADD ITEM ===
function openAddItemModal(cid){const c=cats[cid];tempUploadImg='';
  openModal('<h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô '+c.emoji+' '+c.name+'</h3>'+
    '<div class="input-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label><input class="input-field" id="m_in" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏•‡∏≤‡∏ó‡∏π"></div>'+
    '<div class="input-group"><label class="input-label">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label><input class="input-field" type="number" id="m_ip" placeholder="50"></div>'+
    '<div class="input-group"><label class="input-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label><input class="input-field" id="m_iu" placeholder="‡∏Å‡∏Å." value="‡∏Å‡∏Å."></div>'+
    '<div class="input-group"><label class="input-label">Emoji</label><input class="input-field" id="m_ie" placeholder="üêü" maxlength="4"></div>'+
    uploadModalHTML('')+
    '<button class="btn-primary btn-success" onclick="doAddItem(\''+cid+'\')">‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>')}
function doAddItem(cid){const name=document.getElementById('m_in').value.trim(),price=parseInt(document.getElementById('m_ip').value)||0;
  if(!name||!price){showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤');return}
  if(!cats[cid].items)cats[cid].items=[];
  cats[cid].items.push({id:gid(),name,price,unit:document.getElementById('m_iu').value.trim()||'‡∏Å‡∏Å.',emoji:document.getElementById('m_ie').value.trim()||'üì¶',img:tempUploadImg,bg:'#f5f0ea'});
  if(!persist()){showToast('‚ö†Ô∏è ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏°! ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á');return}
  closeModal();renderAdminProducts();renderAdminStats();showToast('‡πÄ‡∏û‡∏¥‡πà‡∏° "'+name+'" ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ')}

// === EDIT ITEM ===
function openEditItemModal(cid,iid){const c=cats[cid];if(!c)return;const it=(c.items||[]).find(i=>i.id===iid);if(!it)return;
  tempUploadImg=it.img||'';
  openModal('<h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç '+it.emoji+' '+it.name+'</h3>'+
    '<div class="input-group"><label class="input-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label><input class="input-field" id="m_in" value="'+it.name+'"></div>'+
    '<div class="input-group"><label class="input-label">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label><input class="input-field" type="number" id="m_ip" value="'+it.price+'"></div>'+
    '<div class="input-group"><label class="input-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label><input class="input-field" id="m_iu" value="'+(it.unit||'‡∏Å‡∏Å.')+'"></div>'+
    '<div class="input-group"><label class="input-label">Emoji</label><input class="input-field" id="m_ie" value="'+it.emoji+'" maxlength="4"></div>'+
    uploadModalHTML(it.img||'')+
    '<button class="btn-primary" onclick="doEditItem(\''+cid+'\',\''+iid+'\')">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>')}
function doEditItem(cid,iid){const it=(cats[cid].items||[]).find(i=>i.id===iid);if(!it)return;
  it.name=document.getElementById('m_in').value.trim()||it.name;it.price=parseInt(document.getElementById('m_ip').value)||it.price;
  it.unit=document.getElementById('m_iu').value.trim()||it.unit;it.emoji=document.getElementById('m_ie').value.trim()||it.emoji;it.img=tempUploadImg;
  if(!persist()){showToast('‚ö†Ô∏è ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πá‡∏°!');return}
  closeModal();renderAdminProducts();showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úÖ')}

function delItem(cid,iid){const c=cats[cid];if(!c)return;const it=(c.items||[]).find(i=>i.id===iid);if(!it)return;
  if(!confirm('‡∏•‡∏ö "'+it.name+'" ?'))return;c.items=c.items.filter(i=>i.id!==iid);persist();renderAdminProducts();renderAdminStats();showToast('‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß')}

function saveSettings(){settings.laterFee=parseInt(document.getElementById('adminFee').value)||20;
  const np=document.getElementById('adminNewPass').value.trim();if(np)settings.adminPass=np;
  sv('of_set',settings);showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‚úÖ')}

// INIT
renderHome();
</script>
</body>
</html>
